## 一.序列比对

> 序列比对的意义：序列比对的理论基础是进化学说，如果两个 序列之间具有足够的相似性，就推测二者可 能有共同的进化祖先，经序列内残基或者序 列片段的替换、插入、缺失等遗传编译过程 分别演化而来。  相似性高并不一定来自同一祖先。
>
> 进行一个序列比对需要做那些事情？需要给出一个目标来揭示什么是相似、什么是不相似
>
> 一般从进化意义上分析,蛋白比对比核苷酸更可取
>
> 多序列比对是为了获取某一种生物学特征（MEGA），单序列比对获得一种信息（BLAST-FAST）

### 1.1 相似性

**基本序列类型**：蛋白质序列、核酸序列（4中碱基）；

**FASTA格式**：第一行：大于号加名称或其他注释；第二行以后：每行60个字母

**序列相似性的重要性：**相似的序列往往起源于同一个共同的祖先序列，他们很可能有相似的空间结构和生物学功能，因此对于一个已知序列但结构和功能的蛋白，如果与它序列相似的某些蛋白质的结构和功能已知，则可以推测这个未知结构和功能的蛋白质的结构和功能。 

**替换得分矩阵**：反映了残基之间相互替换率的矩阵，描述了残基两两相似的量化关系，

（1）等价得分矩阵：相同得分为1，不同的分为0，不含有生物信息，只用于理论计算

（2）碱基替换替换（转换-颠换）矩阵：在进化过程中，不同碱基替换发生的情况不同。

（3）BLAST矩阵：序列相同+5，序列不同-4，广泛被DNA采用

**蛋白质序列替换得分矩阵：**(PAM矩阵基于近似序列的统计，从进化距离近的数据外推到远。 BLOSUM矩阵基于蛋白家族中的多序列比对统计)

（1）等价矩阵

（2）PAM矩阵（突变数据矩阵）：基于进化原理，在蛋白质中被自然选择接受的单个氨基酸替换，如果两种氨基酸替换频繁，说明自然界接受这种替换，那么这对氨基酸替换得分应该高。PAM-1相似度大于85%序列计算而出，PAM-250，是通过PAM-1自乘得到 

> PAM-n中，n 越小，表示氨基酸变异的 可能性越小；相似的序列之间比较应该 选用n值小的矩阵，不太相似 的序列之 间比较应该选用n值大的矩阵。PAM- 250用于约20%相同序列之间的比较。

（3）BLOSUM矩阵：通过大量的符合特定要求的序列计算而来，相似性是根据真实数据产生的，例如BLOSUM-80中的80，就是指矩阵是由一致性>=80%的序列计算而来的。正数为相似，负数为不相似。

> BLOSUM-n中，n越小，表示氨基酸相 似的可能性越小；相似的序列之间比较 应该选用 n 值大的矩阵，不太相似的序 列之间比较应该选 用n值小的矩阵。 BLOSUM-62用来比较62％相似度的序 列，BLOSUM-80用来比较80％左右的 序列。

![1640500115620](C:\Users\s1257\AppData\Roaming\Typora\typora-user-images\1640500115620.png)

（4）遗传密码矩阵（GCM）：通过计算一个氨基酸转换成另一个氨基酸所需密码子变化的数目而得到的，矩阵的值对应为据此付出的代价。常用于进化距离的计算，其优点是可以直接绘制进化树，但是在蛋白质序列对比（尤其是相似度低的序列对比）中很少使用。

（5）疏水矩阵：根据氨基酸疏水性前后变化的来

![1640501699861](C:\Users\s1257\AppData\Roaming\Typora\typora-user-images\1640501699861.png)

### 1.2 双序列比对

**序列比对**（alignment）：运用特定的算法找出两个或多个序列之间产生最大相似度得分的空格插入和序列排序方案。（例如两序列间，插入gap，找出使得两条序列最大相似度得分的排列方式和空格插入方式 ）；

**双序列比对**：（1）全局比对：用于比较两个长度相似的序列（2）局部比对：用于比较一长一短两条序列

**NW算法**：基于替换的得分矩阵，将动态规划应用于两条序列的全局比对

![1640501925249](C:\Users\s1257\AppData\Roaming\Typora\typora-user-images\1640501925249.png)

结果为：ACGTC，AA-TC （局部比对算法，则增加max（0 ））

双序列比对工具：EMBL、PIR、Lalign、LAGAN、AlignMe、MCALIGN

### 1.3 ＢＬＡＳＴ（BLAST未做双序列比对，牺牲了准确度提高速度）

![1640503638997](C:\Users\s1257\AppData\Roaming\Typora\typora-user-images\1640503638997.png)

![1640504069712](C:\Users\s1257\AppData\Roaming\Typora\typora-user-images\1640504069712.png)

**BLAST工具中的相关参数**：（1）E-value：期望值E越接近于0，说明输入序列与当前这条序列为同一条序列的可能性越大（2）Ident：根据E-value排序得到的top数据，进行的双序列比对得出的

> E-value是两序列间的相似性的显著性，查看是否可以替代；Bootstrap是建树使用的多序列，查看构建的树是否具有稳定性

### 1-4 其他算法的BLAST

> 因BLAST只能获取相似性高的，而遗漏远亲，例如如果想通过BLAST搜索一个蛋白质家族，则做不到
>
> PSI-BLAST  >  BLAST  > PHI-BLAST

**（1）PSI-BLAST**   : 利用位置特异权重矩阵（PSSM），利用多次搜索，通过迭代扩大搜索范围。

**（2）PHI-BLAST**  ：模式识别序列，找到与输入序列相似并且符合某种特定模式的序列（正则表达式）代表某个酶的活性位点、或者一个蛋白质家族的结构域、功能域

###  1-5 多序列比对

**多序列比对的用途** ： 

> 寻找最高的得分：MAFFT、ClustalW、Prank、Muscle

（1）确认未知序列是否属于某个蛋白质家族（2）建立系统发生树、查看物种序列间的关系（3）模式识别：保守位点和保守片段（４）已知推未知：根据已有多序列功能推测未知序列是否也具有该功能。（５）预测二级结构

**多序列比对的要求**　：

## 二.进化树

**生物大分子的进化特征：**如果以核酸或蛋白质的一级结构的改变 (即分子序列中核苷酸或氨基酸的替换数) 作为进化改变量的测度，那么生物大分 子随时间的改变(即分子进化速率)是相当 稳定的，其原因可能是“替换”是一个 没有特殊驱动和控制的随机过程。

**分子进化速率的恒定性:** 进化过程中置换绝大部分是 中性或近似中性的突变随机固定的结果。功能上对 生命生存制约性低的分子或一个分子中不那么重要 的部分，较之对生命生存制约性高的分子或分子中 重要的部分，其突变率置换率高。 **多态性的来源:** 许多蛋白质多态性必须在选择上为中 性或近中性，并在群体中由突变引入与随机灭绝间 两者的平衡维持

**进化树理论依据：**不同物种同源大分子的进化速率大体相同， 如不同动物的血红蛋白分子的进化速率基本 上每个氨基酸位点每年替换10-9次。 – 分子进化方法就是利用上述特点，通过不同 物种的同源大分子的比较，来确定物种间的 亲缘关系，分支时间，进而定出系统进化树 的

**基本思想:** 物种体内同功能生物分子（如蛋白质或核酸分子） 的相似程度越高，则物种的亲缘关系越近。

 **具体步骤**: •（1）选择“特征分子”，原则是：a. 各个物种都有的 同源分子，b. 进化速率适当; •（2）对这些同源分子的序列进行多序列比对(multi- sequences alignment), 截取比对的最好的区域作为 物种的代表序列；（3）按某种方法，算出代表序列两两之间的 差异度(如: 比对打分, p=n/N, D=-0.75ln(1- 4p/3) …)（4）基于这些差异度，绘制系统发生树（5）对系统发生树进行可信度检验(bootstrap)

**主要方法**：

>  距离法（UPGMA、Neighbor-Joining）、 – 最大简约法 （Maximum parsimony，MP） – 最大似然法 （Maximum likelihood，ML）
>
> 近缘序列: 最大简约法 • 远缘序列: 最大似然法或基于距离矩阵的方法 • 若序列有较高的相似性，各种方法都会得到不错 的结果，模型间的差别也不大

**（1）距离法（UPGMA、Neighbor-Joining）**

> 对要研究的一组物种(或序列), 采用某种规 则, 算出两两之间的距离, 构造出距离矩阵; 2. 选出距离最近的两个物种(比如A和C), 把 其余的物种看成一个“复合物种”, A到 “复合物种”的距离是A和构成“复合物 种”的所有物种的距离的平均，C亦然；求出A、C、“复合物种”三者构成的 树的分支长度a,c,(复合物种)，这时，A、 C的“紧邻分支长度已确定”； 4. 将“紧邻分支长度已确定” 的A、C看 成一个“复合物种”（AC），计算其 它各物种到（AC）的距离，构造出新 的（少了一维的）距离矩阵； 5. 按照同样的办法，一遍遍重复2到4的 步骤，就可逐步确定出树的整体结构及 全部分支长度

![1640519814321](C:\Users\s1257\AppData\Roaming\Typora\typora-user-images\1640519814321.png)

该方法的优点是： – 不要求物种(序列)的相似程度必须很高，并 且计算速度快，能处理物种(序列)数目较大 的情况； • 缺点是： – 不能保证找到的是最优的树。

**Bootstrap**:从整个序列的碱基（氨基酸）中 任意选取一半，剩下的一半序列 随机补齐组成一个新的序列。这 样，一个序列就可以变成了许多 序列，一个多序列组也就可以变 成许多个多序列组。每个多序列 组都可以生成一个进化树。将生 成的许多进化树进行比 较，按照 多数规则（majority-rule）我们就 会得到一个最“逼真”的进化树。

> BOOTSTRAP值的意义：根据你所选的统 计计算模型，设定初始值1000次，即让模 型计算并绘制1000株系统发育树，这是命 令阶段产生的 ，而系统发育树中每个节点 上的数字，则代表在命令阶段要求的1000 次进化树分析中 有多少次是具有相同的进化分类的关系 ; ; ;则说明这个物种的进化是服从相同的规律。局部信息达成结果说明是随机发生的。 (Phylip , mega)

## 三，基因组学

![1640520376508](C:\Users\s1257\AppData\Roaming\Typora\typora-user-images\1640520376508.png)

**基因组重测序数据分析**：测序基本结果分析  基因组定位  单核苷酸多态性位点(SNPs)检测和功能分析  插入和缺失位点(Indels)检测和功能分析  拷贝数变异(Copy Number Variations, CNVs) 检测和相关分析  其他基因组结构变异(Structural Variations, CVs)检测和相关分析  重新组装个体基因组

**转录组测序数据分析**：（1）有参考基因组的转录组分析（Reference）  测序原始数据处理（质量剪切、污染序列去除等）  短序列mapping至参考基因组序列  基因功能注释  基因结构分析  可变剪切分析  基因表达差异分析  预测新的基因  （2）无参考基因组转录组分析 （De novo）  测序原始数据处理（质量剪切、污染序列去除等）  Contig和Unigene统计分析  基因功能注释  SNPs分析等  基因表达差异分析

**RNA 测序数据分析**：基因组定位  测序结果分类(microRNA, piRNA, tRNA, snRNA, rRNA, snoRNA 等)  计算已知 microRNA 的表达量  MicroRNA的家族、基因座分类  预测新的 microRNA 基因  进化分析  microRNA 基因簇分析

![1640520513009](C:\Users\s1257\AppData\Roaming\Typora\typora-user-images\1640520513009.png)

**基因识别—**—使用计算机手段识别DNA序列上的具 有生物学特征的片段，其对象主要是蛋白质编码基 因，也包括其他具有一定生物学功能的因子，如 RNA、MicroRNA基因等一些非编码基因，基因识 别是生物信息学领域里的一个重要研究内容。

**原核识别：** 原核基因是DNA分子的一个片段，具有连续编码的结 构特征 ，原核基因识别——重点在于识别编码区域，辨别编码区与非编码区的一种方法  检查终止密码子的出现频率

> (1) 基本原理：如果能够找到一个比较长的序列，其相应的密 码子序列不含终止密码子，则这段序列可能就 是编码区域。 （2）基本方法：扫描DNA序列，在三个不同的阅读框中寻找 较长的ORF。遇到终止密码子以后，回头寻找 起始密码子

**真核识别：**真核生物的基因一般为断裂基因（interrupted gene），基因的编码序列在DNA放在上不是连续 的，而是被不编码的序列隔开； • 外显子（exon）：基因中编码的序列，与成熟 mRNA的序列相对应。 • 内含子（Intron）：基因中不编码的序列。 • 真核基因具有丰富的调控信息

> 两大类识别方法： (1)基于同源序列比较的方法  利用已知的基因编码信息（如mRNA或蛋白质序 列），通过同源比较，在DNA序列中发现潜在的编 码序列。 (2) 基于序列特征的方法  根据DNA本身所具有的序列特征预测编码基因 理想的方法：综合两大类方法优点，开发混合算法。

（1）同源序列比较法：通过相似性比对发现编码序列；DNA序列的某一片段与mRNA或蛋白质序列具有高度 相似性，这说明该DNA片段极有可能是编码序列。

（2）基于序列特征的方法: 一般意义上基因具有两种类型的特征  一类特征是“信号”，由一些特殊的序列构 成，通常预示着其周围存在着基因。  另一类特征是“内容”，即蛋白质编码基因 所具有的某些统计学特征

> 序列特征信号  转录启动信号  起始密码子  外显子 剪接位点（GT–AG法则）  终止密码子  转录终止信号（包含多聚Ａ序列）  整个基因编码区长度一定是3的倍数

**密码子使用偏爱性** : 密码子简并性: 同一种氨基酸 具有两个或更多个密码子编 码的现象。 密码子偏爱性: 兼并密码子 的使用频率并不均等，各种 生物编码某种氨基酸往往较 多地采用其中一种 ;  利用密码子使用频率对序列进行分析可以发现编码区 的粗略位置  【如果一段DNA序列的阅读框出现许多偏爱密码 子（双联密码子），则该区域很有可能就是基 因的编码区域】

**真核常见软件** ： FGENEH、GeneID、GeneParser、GRAIL

## 四、高通量测序

（1）Sanger 测序法 ： Sanger法是根据核苷酸在某一固定的点开始，随机在某一个特定的碱基处终止，并且在每个碱基后面进行荧光标记，产生以A、T、C、G结束的四组不同长度的一系列核苷酸，然后在尿素变性的PAGE胶上电泳进行检测，从而获得可见DNA碱基序列的一种方法。

（2）Illumina Sequencing ：一、sample prep（样本准备）：基因文库制备（一个基因组切断再加接头）二、cluster generaton（簇的形成）：文库在测序芯片（流动池flowcell）上不断扩增，形成桥式PCR，再切掉反向链（reverse strand），形成许多簇相同的正向序列（正向链forward strand）。三、sequencing（测序）：荧光信号、可逆阻断终止技术、Sequences-by-Synthesis 四、data analysis（数据分析）

（3）纳米孔：单分子测序

**如何把测得的序列片段匹配到基因组上**？Hash 或者 BWA算法进行匹配

**BWA Burrows-Wheeler Alignment**

（1）循环排列n次，（2）按照第一个ASCII排序（3）取最后一一列作为BWT

![1640523960145](C:\Users\s1257\AppData\Roaming\Typora\typora-user-images\1640523960145.png)

 ![1640524099396](C:\Users\s1257\AppData\Roaming\Typora\typora-user-images\1640524099396.png)

## 五、高通量测序分析

**分析流程：**1.差异表达基因的分析: 寻找处理前后表达上调或者下调 的基因  2. 使用标准的统计学方法检验 (t-test)，发现统计显著性 差异表达的基因，  3. 如果处理本身并不显著，则结果无意义

Fold change, 一般2-fold increase or decrease (平行 实验的样本较少)  2. P-value (平行实验的样本较多)

**多重检验假设**：每个基因的差异表达 p-value假设为 0.01  假如两万个差异基因，将有0.01 x 20K = 200 基因的判断是错的  Bonferroni 校正，p-value/N ；  FDR（FalseDiscovery Rate） 校正。

**Pearson系数**：它是一种度量两个变量间相关程度的方法。 它是一个介于 1 和 -1 之间的值，其中，1 表示变 量完全正相关， 0 表示无关，-1 表示完全负相关 : Pearson积差相关系数（量纲对等），1，2，3，4  ~~~ 100，200，300，400  ==== P（x） == 0.9999

**基因聚类** ： 将表达谱相似的基因聚类在一起  聚类方法：  A. K-means clustering  B. Hierarchical clustering

> 聚类的目的  可诱导基因是共表达的  可以揭示细胞的生理状态  可以帮助研究未知基因的功能

**k-means 算法基本步骤**  （1） 从 n个数据对象任意选择 k 个对象作为初始聚 类中心；  （2） 根据每个聚类对象的均值（中心对象），计算 每个对象与这些中心对象的距离；并根据最小距离重 新对相应对象进行划分；  （3） 重新计算每个（有变化）聚类的均值（中心对 象）；  （4） 计算标准测度函数，当满足一定条件，如函数 收敛时，则算法终止；如果条件不满足则回到步骤 （2）

> 树状聚类采用局部最优，强制分配，其依赖于初始状态。可能造成错误，不是全局最优，（1，2）3，（4，5） 或许 1（2，3，4）5才是最优

**Hierarchical clustering:** 用树状结构来表征基因表 达之间的相似性/相关性  2. 优点：不需要指定结果有 多少类

**基因芯片**：将样品中的DNA/RNA表 上荧光标记，则可以定 量检验基因的表达水平 ：（快速  高通量(104 - 106)  自动化  使用的试剂少  低成本）

**芯片设计分类**  寡核苷酸芯片（20～80碱基，特异性好）  cDNA芯片（300～1500碱基，成本低）

 **芯片荧光物质分类**  双通道 （两个样本用不同荧光标记后一起杂交到同一张芯片上， Cy5（红）和Cy3（绿）两种荧光物质，可靠性高）  单通道（单一荧光标记, 数据变异大，需要重复）

**基因探针：**灵敏性：与样本中靶标序列相互结合的能力  探针不会形成稳定的二级结构和同源二聚体  特异性：不与样本中的非靶标序列结合。  探针和靶标序列的连续匹配长度不能过大或过长，低 复杂度的序列要尽可能的小

## 六、蛋白质结构

> 一级结构: 序列  二级结构: alpha螺旋, beta片层  三级结构: 单体  四级结构: 多聚体

**结构相似性衡量**：RMSD：均匀方差，重叠蛋白r1，r2，C原子位置，单位为A

**蛋白质三维结构预测作用**：用途：蛋白质相互作用、大分子复合物的组装、优 化和完善实验所得结构（X-ray 、 NMR以及电镜结 构）、药物设计、功能注释、蛋白质工程等

**折叠好的状态，能量函数：**bond lengths、bond angles 、electrostatics 、 van der Waals、dihedral angles、hydrogen bonds

**搜索算法：**蒙特卡罗  遗传算法  动态规划  宽/深度优先搜索  DEE  贪婪算法

**三维结构主要预测方法：** 

(1) 同源模建 Homology modeling ：  模板 --> 对齐 --> 网络生成 --> 循环建模 --> 侧链计算 -->  最优化模型 --> 验证

 (2) 折叠识别Fold Recognition/Threading 不依赖于模板的结构预测 :  小片段

(3) 从头计算Ab initio/de novo prediction

## 七、分子对接

> 预测受体和配体分子形成的复合物结构 , 分子对接分为两类 :(1)蛋白－蛋白分子对接 (2)蛋白－小分子的对接

**分子对接原理：**理论基础：  “锁和钥匙模型”  “诱导契合模型”（配体与受体的结合强度取决于结合的自由能变化） ；；；重要原则：  互补性：决定识别过程的选择性  预组织性：决定识别过程的结合能力

**计算实现：** （1）搜索算法：如何找到最佳的结合位置 遗传算法 模拟退火 （2）能量函数：如何评估结合强度 基于分子力场的方法 基于经验的方法 基于知识统计的打分函数

**发现口袋**：（1）几何分析法--表面积、3D结构、补结构等 （2）综合信息：蛋白质家族中，根据进化关系寻找口袋

**分子对接** ： 刚性对接：研究体系的构象不发生变化。  柔性对接：研究体系的构象是可以自由变 化的。

**刚性对接：**受体活性位点、配体、代表基团空间匹配

 **柔性对接：**片段生长（DOCK和Flexx）、锚定点搜索（AutoDOCK） 、构想群对接（MDock）

**分子对接计算的注意点**：（1）小分子问题 起始构象对对接结果有一定影响 对分子进行加电荷和加氢处理  （2）蛋白质问题 如何选择合理的蛋白质活性位点  （3）对接问题 搜索结合模式的正确性、对接的效率、评分的正确性 采用多个软件进行评价，减少结合模式搜索误差 定量指标，需要结合分子动力学进一步评价

**现代药物的开发方法：**

疾病 **→** 生物学模型界定的靶点 **→** 高通量（虚拟）筛选 **→** 发现先导化合物（亲和力高，有修改潜力）**→** 亲和力优化、药代性质优化 **→** 安全性评价、临床实验  （10% 10%的概率）

## End，各种数据库

INSD：国际核酸序列数据库（International Nucleotide Sequence Databank）。由日本的DDBJ、欧洲的EMBL和美国的GenBank三家各自建立和共同维护。
EMBL库：欧洲分子生物学实验室的DNA和RNA 序列库。
GenBank ：美国国家生物技术信息中心 （NCBI）所维护的供公众自由读取的、带注释的DNA序列的总数据库。
DDBJ ：日本核酸数据库。
GSDB：美国国家基因组资源中心（NCGR）维护的DNA序列关系数据库（Genome Sequence DataBase）。
TIGR DATAbase：世界上最大的cDNA数据库，还有大量的EST序列和人类基因索引（HGI）。

**蛋白质结构和分类数据库**：PDB：蛋白质结构数据库。、RCSB：结构生物信息学信息学合作研究组织。、FAMBASE：是每个蛋白质家族的代表序列的集合，它有助于加速同源性搜索。、ProtFam：蛋白质超家族的序列联配数据库。

**核酸序列的预测分析**

重复序列分析：CENSOR 、RepeatMasker 、XBLAST
核酸序列的预测分析
1)数据库搜索：NCBI的BLAST
2)编码区统计特性分析:GRAIL、GenMARK
蛋白质结构和功能的预测分析
1)预测蛋白质的物理性质：ExPASy、PROPSEARCH、SAPS
2)蛋白质二级结构预测
NnPredict、PredictProtein、Tmpred、SignalP
3)蛋白质三维结构预测
SWISS-MODEL、PSI-BLAST